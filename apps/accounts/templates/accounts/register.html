{% extends 'base.html' %}
{% block title %}Inscription — EduBot{% endblock %}

{% block content %}
<div class="min-h-[85vh] flex items-center justify-center px-4 py-16">
  <div class="w-full max-w-md animate-slide-up">

    <div class="text-center mb-10">
      <div class="w-16 h-16 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl mx-auto mb-5 flex items-center justify-center shadow-xl animate-float">
        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"/>
        </svg>
      </div>
      <h1 class="text-3xl font-extrabold text-gray-900 mb-2">Rejoins <span class="gradient-text">EduBot</span></h1>
      <p class="text-gray-500 text-sm">Crée ton compte gratuit et commence à apprendre</p>
    </div>

    <div class="card">
      <form method="post" class="space-y-5">
        {% csrf_token %}

        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">Nom d'utilisateur</label>
          <div class="relative">
            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
            </div>
            <input type="text" name="username" required class="input-field pl-11" placeholder="ex: zeus_trader">
          </div>
        </div>

        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">Email</label>
          <div class="relative">
            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
            </div>
            <input type="email" name="email" required class="input-field pl-11" placeholder="zeus@edubot.tg">
          </div>
        </div>

        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">Mot de passe</label>
          <div class="relative">
            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/></svg>
            </div>
            <input type="password" name="password1" id="pwd1" required class="input-field pl-11 pr-12" placeholder="Min. 8 caractères">
            <button type="button" onclick="togglePwd('pwd1')" class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-violet-600 transition-colors">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
            </button>
          </div>
        </div>

        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">Confirmer le mot de passe</label>
          <div class="relative">
            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
            </div>
            <input type="password" name="password2" id="pwd2" required class="input-field pl-11 pr-12" placeholder="Répète ton mot de passe">
            <button type="button" onclick="togglePwd('pwd2')" class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-violet-600 transition-colors">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
            </button>
          </div>
        </div>

        <!-- Indicateur force mot de passe -->
        <div id="pwdStrength" class="hidden space-y-1">
          <div class="flex gap-1.5">
            <div id="s1" class="h-1.5 flex-1 rounded-full bg-gray-200 transition-all duration-300"></div>
            <div id="s2" class="h-1.5 flex-1 rounded-full bg-gray-200 transition-all duration-300"></div>
            <div id="s3" class="h-1.5 flex-1 rounded-full bg-gray-200 transition-all duration-300"></div>
            <div id="s4" class="h-1.5 flex-1 rounded-full bg-gray-200 transition-all duration-300"></div>
          </div>
          <p id="pwdLabel" class="text-xs text-gray-400 font-medium"></p>
        </div>

        <button type="submit" class="btn-primary w-full justify-center py-3.5 text-sm mt-2"
          style="background:linear-gradient(135deg,#059669,#0d9488); box-shadow:0 4px 20px rgba(5,150,105,0.3)">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
          Créer mon compte gratuit
        </button>
      </form>

      <div class="flex items-center gap-4 my-6">
        <div class="flex-1 h-px bg-violet-100"></div>
        <span class="text-gray-400 text-xs uppercase tracking-wider">ou</span>
        <div class="flex-1 h-px bg-violet-100"></div>
      </div>

      <p class="text-center text-gray-500 text-sm">
        Déjà inscrit ?
        <a href="{% url 'login' %}" class="text-violet-600 font-semibold hover:text-violet-700 ml-1">Se connecter</a>
      </p>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
function togglePwd(id) {
  const input = document.getElementById(id);
  input.type = input.type === 'password' ? 'text' : 'password';
}
const strengthColors = ['bg-red-400','bg-orange-400','bg-yellow-400','bg-emerald-500'];
const strengthLabels = ['Très faible','Faible','Moyen','Fort'];
document.getElementById('pwd1').addEventListener('input', function() {
  const val = this.value;
  document.getElementById('pwdStrength').classList.toggle('hidden', val.length === 0);
  let score = 0;
  if (val.length >= 8) score++;
  if (/[A-Z]/.test(val)) score++;
  if (/[0-9]/.test(val)) score++;
  if (/[^A-Za-z0-9]/.test(val)) score++;
  ['s1','s2','s3','s4'].forEach((id, i) => {
    document.getElementById(id).className =
      `h-1.5 flex-1 rounded-full transition-all duration-300 ${i < score ? strengthColors[score-1] : 'bg-gray-200'}`;
  });
  document.getElementById('pwdLabel').textContent = score > 0 ? strengthLabels[score-1] : '';
});
</script>
{% endblock %}
